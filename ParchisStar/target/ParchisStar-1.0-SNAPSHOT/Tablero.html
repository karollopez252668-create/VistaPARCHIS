<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Tablero de Juego</title>
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

        <link href="https://fonts.googleapis.com/css2?family=Kufam:ital,wght@0,400..900;1,400..900&display=swap" rel="stylesheet">

        <link rel="stylesheet" href="css/Tablero.css"/>

    </head>
    <body>
        <div class="encabezado-juego">
            <div class="seccion-tiempo">
                <div class="etiqueta-tiempo">Tiempo Restante</div>
                <div class="barra-tiempo">
                    <div class="progreso-tiempo" id="barraProgreso"></div>
                </div>
            </div>
            <button class="boton-config-juego" id="botonCoord">
                <img src="assets/Confi.png" alt="alt"/>
            </button>
        </div>

        <div class="contenedor-juego">
            <!-- Contenedor Izquierda: Jugadores 1 y 3 -->
            <div class="contenedor-izquierda">
                <!-- Jugador 1: Alexa777 (Verde - Arriba Izquierda) -->
                <div class="jugador-lateral" data-jugador="1">
                    <div class="flecha-jugador">↓</div>
                    <div class="avatar-lateral">
                        <img src="assets/1.jpg" alt="Alexa777">
                    </div>
                    <div class="nombre-lateral">Alexa777</div>
                    <div class="dados-jugador">
                        <div  class="dado">
                            <img class="dado" src="assets/D1.jpg" alt="alt"/>
                        </div>

                    </div>
                </div>

                <!-- Jugador 3: Papurrita05 (Rojo - Abajo Izquierda) -->
                <div class="jugador-lateral" data-jugador="3">
                    <div class="flecha-jugador">↓</div>
                    <div class="avatar-lateral">
                        <img src="assets/2.jpg" alt="Papurrita05">
                    </div>
                    <div class="nombre-lateral">Papurrita05</div>
                    <div class="dados-jugador">
                        <div class="dado">
                            <img class="dado" src="assets/D1.jpg" alt="alt"/>
                        </div>

                    </div>
                </div>
            </div>

            <!-- Tablero Central -->
            <div class="contenedor-tablero">
                <div id="debug-container"></div>
                <img src="assets/Foto tablero.png" alt="Tablero" class="imagen-tablero" id="imagenTablero">
                <div class="capa-casillas" id="capaCasillas"></div>
            </div>

            <!-- Contenedor Derecha: Jugadores 2 y 4 -->
            <div class="contenedor-derecha">
                <!-- Jugador 2: Eliu (Amarillo - Arriba Derecha) -->
                <div class="jugador-lateral" data-jugador="2">
                    <div class="flecha-jugador">↓</div>
                    <div class="avatar-lateral">
                        <img src="assets/3.jpg" alt="Eliu">
                    </div>
                    <div class="nombre-lateral">Eliu</div>
                    <div class="dados-jugador">
                        <div class="dado">
                            <img class="dado" src="assets/D1.jpg" alt="alt"/>
                        </div>

                    </div>
                </div>

                <!-- Jugador 4: Crisr22 (Azul - Abajo Derecha) -->
                <div class="jugador-lateral" data-jugador="4">
                    <div class="flecha-jugador">↓</div>
                    <div class="avatar-lateral">
                        <img src="assets/4.jpg" alt="Crisr22">
                    </div>
                    <div class="nombre-lateral">Crisr22</div>
                    <div class="dados-jugador">
                        <div class="dado">
                            <img class="dado" src="assets/D1.jpg" alt="alt"/>
                        </div>

                    </div>
                </div>
            </div>
        </div>

        <script>
            // CONFIGURACIÓN DE JUGADORES (cambia este número según jugadores conectados)
            const jugadoresConectados = 2; // Puede ser 2, 3 o 4

            // COORDENADAS DE LAS BASES (ajusta estas coordenadas manualmente)
            const coordenadasBases = {
                verde: [
                    {x: 13.7, y: 13.7},
                    {x: 26.5, y: 13.7},
                    {x: 13.7, y: 26.6},
                    {x: 26.5, y: 26.6}
                ],
                amarillo: [
                    {x: 73.7, y: 13.8},
                    {x: 86.5, y: 13.8},
                    {x: 73.7, y: 26.5},
                    {x: 86.5, y: 26.6}
                ],
                rojo: [
                    {x: 13.6, y: 86.4},
                    {x: 13.6, y: 73.7},
                    {x: 26.5, y: 86.4},
                    {x: 26.5, y: 73.5}
                ],
                azul: [
                    {x: 73.7, y: 73.8},
                    {x: 86.5, y: 73.8},
                    {x: 73.7, y: 86.4},
                    {x: 86.5, y: 86.4}
                ]
            };

            // Crear fichas en las bases (solo para jugadores conectados)
            function crearFichas() {
                const capa = document.getElementById('capaCasillas');
                const coloresActivos = obtenerColoresActivos();

                coloresActivos.forEach(color => {
                    coordenadasBases[color].forEach((pos, index) => {
                        const ficha = document.createElement('div');
                        ficha.className = `ficha ${color}`;
                        ficha.dataset.color = color;
                        ficha.dataset.numero = index + 1;
                        ficha.style.left = pos.x + '%';
                        ficha.style.top = pos.y + '%';

                        // Agregar estrella dentro de la ficha
                        const estrella = document.createElement('div');
                        estrella.className = 'estrella-ficha';
                        estrella.textContent = '★';
                        ficha.appendChild(estrella);

                        capa.appendChild(ficha);
                    });
                });
            }

            // Obtener colores activos según jugadores conectados
            function obtenerColoresActivos() {
                const ordenColores = ['verde', 'amarillo', 'rojo', 'azul'];
                return ordenColores.slice(0, jugadoresConectados);
            }

            // Mostrar/ocultar jugadores según conexión
            function configurarJugadores() {
                const todosJugadores = document.querySelectorAll('.jugador-lateral');

                // Ocultar todos primero
                todosJugadores.forEach(j => j.style.display = 'none');

                // Mostrar solo los activos según el número de jugadores
                for (let i = 1; i <= jugadoresConectados; i++) {
                    const jugador = document.querySelector(`[data-jugador="${i}"]`);
                    if (jugador) {
                        jugador.style.display = 'flex';
                    }
                }
            }


            // Temporizador
            let tiempoRestante = 100;
            function actualizarTiempo() {
                const barra = document.getElementById('barraProgreso');
                tiempoRestante -= 2.0;
                if (tiempoRestante < 0)
                    tiempoRestante = 100;
                barra.style.width = tiempoRestante + '%';

                if (tiempoRestante < 30) {
                    barra.style.background = 'linear-gradient(90deg, #F44336 0%, #FF5722 100%)';
                } else if (tiempoRestante < 60) {
                    barra.style.background = 'linear-gradient(90deg, #FFC107 0%, #FFD54F 100%)';
                } else {
                    barra.style.background = 'linear-gradient(90deg, #4CAF50 0%, #8BC34A 100%)';
                }
            }

            const casillas = [
                {id: 1, x: 56.2, y: 89.5},
                {id: 2, x: 56.8, y: 82.9},
                {id: 3, x: 56.8, y: 76.2},
                {id: 4, x: 56.6, y: 69.7},
                {id: 5, x: 56.6, y: 63.1},
                {id: 6, x: 62.6, y: 57.0},
                {id: 7, x: 69.7, y: 57.0},
                {id: 8, x: 76.1, y: 56.2},
                {id: 9, x: 82.4, y: 57.0},
                {id: 10, x: 89.1, y: 56.4},
                {id: 11, x: 95.7, y: 56.4},
                {id: 12, x: 96.1, y: 50.4},
                {id: 13, x: 96.1, y: 43.1},
                {id: 14, x: 89.3, y: 43.3},
                {id: 15, x: 82.6, y: 43.7},
                {id: 16, x: 75.9, y: 43.5},
                {id: 17, x: 69.3, y: 43.5},
                {id: 18, x: 63.2, y: 43.3},
                {id: 19, x: 56.4, y: 37.0},
                {id: 20, x: 56.1, y: 30.0},
                {id: 21, x: 56.6, y: 23.7},
                {id: 22, x: 56.8, y: 17.4},
                {id: 23, x: 56.6, y: 10.4},
                {id: 24, x: 56.4, y: 4.1},
                {id: 25, x: 49.1, y: 3.7},
                {id: 26, x: 43.2, y: 4.3},
                {id: 27, x: 42.8, y: 10.0},
                {id: 28, x: 43.0, y: 17.0},
                {id: 29, x: 42.8, y: 23.3},
                {id: 30, x: 43.0, y: 29.9},
                {id: 31, x: 43.7, y: 37.0},
                {id: 32, x: 36.4, y: 42.5},
                {id: 33, x: 30.1, y: 43.1},
                {id: 34, x: 24.5, y: 43.1},
                {id: 35, x: 16.4, y: 42.7},
                {id: 36, x: 10.7, y: 43.3},
                {id: 37, x: 3.4, y: 43.1},
                {id: 38, x: 3.9, y: 49.3},
                {id: 39, x: 4.3, y: 56.4},
                {id: 40, x: 10.1, y: 56.8},
                {id: 41, x: 17.0, y: 57.0},
                {id: 42, x: 23.4, y: 56.4},
                {id: 43, x: 29.9, y: 56.6},
                {id: 44, x: 36.6, y: 56.8},
                {id: 45, x: 43.2, y: 63.1},
                {id: 46, x: 43.0, y: 69.7},
                {id: 47, x: 42.8, y: 76.4},
                {id: 48, x: 43.4, y: 82.9},
                {id: 49, x: 43.4, y: 89.3},
                {id: 50, x: 43.6, y: 95.8},
                {id: 51, x: 50.1, y: 95.6}
            ];



            function mostrarCoordenadasDebug() {
                const debug = document.getElementById("debug-container");
                debug.innerHTML = ""; // limpia

                casillas.forEach(c => {
                    const dot = document.createElement("div");
                    dot.classList.add("debug-dot");
                    dot.style.left = c.x + "%";
                    dot.style.top = c.y + "%";
                    dot.title = `Casilla ${c.id}`;
                    dot.textContent = c.id;
                    debug.appendChild(dot);
                });
            }

            mostrarCoordenadasDebug();



            // Inicializar
            configurarJugadores();
            crearFichas();
            setInterval(actualizarTiempo, 1000);

            // Evento del botón
            document.getElementById('botonCoord').addEventListener('click', toggleModoCoordernadas);
        </script>
    </body>
</html>